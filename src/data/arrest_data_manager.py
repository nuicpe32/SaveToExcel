#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Arrest data management for Criminal Case Management System
"""

from .base_data_manager import BaseDataManager
from ..config.settings import ARREST_DATA_FILE, PANDAS_AVAILABLE

if PANDAS_AVAILABLE:
    import pandas as pd


class ArrestDataManager(BaseDataManager):
    """Manager for arrest data operations"""
    
    def __init__(self):
        super().__init__(ARREST_DATA_FILE)
        self.arrest_headers = [
            "‡∏Ñ‡∏î‡∏µ‡∏≠‡∏≤‡∏ç‡∏≤‡∏ó‡∏µ‡πà", "‡∏ú‡∏π‡πâ‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏´‡∏≤", "‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤", "‡∏≠‡∏≤‡∏¢‡∏∏", "‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥", "‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏∏‡πà", "‡πÄ‡∏•‡∏Ç ‡∏õ‡∏ä‡∏ä", "‡∏≠‡∏≤‡∏ä‡∏µ‡∏û",
            "‡∏®‡∏≤‡∏•", "‡πÄ‡∏•‡∏Ç‡∏´‡∏°‡∏≤‡∏¢", "‡∏•‡∏á‡∏´‡∏°‡∏≤‡∏¢", "‡∏ß‡∏±‡∏ô‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á", "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏¢‡∏∑‡πà‡∏ô", "‡∏õ‡∏µ‡∏¢‡∏∑‡πà‡∏ô", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö ", "‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏±‡∏ö",
            "‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö", "‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡∏à‡∏±‡∏ö", "‡∏û‡∏¢‡∏≤‡∏ô1", "‡∏û‡∏¢‡∏≤‡∏ô2", "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏", "‡∏Ç‡πâ‡∏≠‡∏´‡∏≤", "‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡πÉ‡∏ô‡∏Ñ‡∏î‡∏µ",
            "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢", "‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á", "‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Ñ‡∏î‡∏µ", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤", "‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡πà‡∏á‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤",
            "‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á", "‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏±‡∏ö", "‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏®‡∏≤‡∏•", "‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á",
            "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏®‡∏≤‡∏•", "‡∏Ç‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á", "‡∏ú‡∏•‡∏Ñ‡∏≥‡∏û‡∏¥‡∏û‡∏≤‡∏Å‡∏©‡∏≤", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏¥‡∏û‡∏≤‡∏Å‡∏©‡∏≤", "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏û‡∏≤‡∏Å‡∏©‡∏≤", 
            "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏î‡∏µ", "‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£", "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£", "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"
        ]
    
    def get_arrest_headers(self):
        """Get arrest data column headers"""
        return self.arrest_headers
    
    def create_empty_arrest_data(self):
        """Create empty arrest data structure"""
        return {header: '' for header in self.arrest_headers}
    
    def get_arrest_field_groups(self):
        """Get organized field groups for arrest form"""
        return [
            ("‚öñÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏î‡∏µ‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏´‡∏≤", [
                ("‡∏Ñ‡∏î‡∏µ‡∏≠‡∏≤‡∏ç‡∏≤‡∏ó‡∏µ‡πà", "case_criminal_no", "entry"),
                ("‡∏ú‡∏π‡πâ‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏´‡∏≤", "accuser", "entry"),
                ("‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡πÉ‡∏ô‡∏Ñ‡∏î‡∏µ", "crime_scene", "text"),
                ("‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢", "damage_amount", "entry")
            ]),
            ("üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤", [
                ("‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤", "suspect_name", "entry"),
                ("‡∏≠‡∏≤‡∏¢‡∏∏", "age", "entry"),
                ("‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥", "nationality", "entry"),
                ("‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà", "address", "text"),
                ("‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô", "id_card", "entry"),
                ("‡∏≠‡∏≤‡∏ä‡∏µ‡∏û", "occupation", "entry")
            ]),
            ("üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏±‡∏ö", [
                ("‡∏®‡∏≤‡∏•", "court", "entry"),
                ("‡πÄ‡∏•‡∏Ç‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏±‡∏ö", "warrant_no", "entry"),
                ("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢", "warrant_date", "entry"),
                ("‡∏•‡∏á‡∏´‡∏°‡∏≤‡∏¢", "warrant_issued", "entry")
            ]),
            ("üìù ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á", [
                ("‡∏ß‡∏±‡∏ô‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á", "petition_day", "entry"),
                ("‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏¢‡∏∑‡πà‡∏ô", "petition_month", "entry"),
                ("‡∏õ‡∏µ‡∏¢‡∏∑‡πà‡∏ô", "petition_year", "entry")
            ]),
            ("üöî ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°", [
                ("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö", "arrest_date", "entry"),
                ("‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏±‡∏ö", "arrest_time", "entry"),
                ("‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö", "arrest_location", "text"),
                ("‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡∏à‡∏±‡∏ö", "arresting_officer", "entry"),
                ("‡∏û‡∏¢‡∏≤‡∏ô 1", "witness_1", "entry"),
                ("‡∏û‡∏¢‡∏≤‡∏ô 2", "witness_2", "entry")
            ]),
            ("‚öñÔ∏è ‡∏Ç‡πâ‡∏≠‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á", [
                ("‡∏Ç‡πâ‡∏≠‡∏´‡∏≤", "charges", "text"),
                ("‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á", "facts", "text")
            ]),
            ("üì§ ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤", [
                ("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤", "transfer_date", "entry"),
                ("‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡πà‡∏á‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤", "transfer_time", "entry"),
                ("‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á", "transfer_agency", "entry"),
                ("‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á", "receiver", "entry")
            ]),
            ("‚öñÔ∏è ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏®‡∏≤‡∏•‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏Ñ‡∏î‡∏µ", [
                ("‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏®‡∏≤‡∏•", "court_order", "text"),
                ("‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á", "order_no", "entry"),
                ("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á", "order_date", "entry"),
                ("‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Ñ‡∏î‡∏µ", "case_result", "text"),
                ("‡∏ú‡∏•‡∏Ñ‡∏≥‡∏û‡∏¥‡∏û‡∏≤‡∏Å‡∏©‡∏≤", "judgment", "text"),
                ("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏¥‡∏û‡∏≤‡∏Å‡∏©‡∏≤", "judgment_date", "entry")
            ]),
            ("üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°", [
                ("‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏", "notes", "text"),
                ("‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏®‡∏≤‡∏•", "court_notes", "text"),
                ("‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏û‡∏≤‡∏Å‡∏©‡∏≤", "judgment_notes", "text"),
                ("‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏î‡∏µ", "case_status", "entry"),
                ("‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£", "document_creator", "entry"),
                ("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£", "document_date", "entry"),
                ("‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°", "additional_notes", "text")
            ])
        ]
    
    def get_key_mapping(self):
        """Get mapping between form keys and Excel columns"""
        return {
            'case_criminal_no': '‡∏Ñ‡∏î‡∏µ‡∏≠‡∏≤‡∏ç‡∏≤‡∏ó‡∏µ‡πà',
            'accuser': '‡∏ú‡∏π‡πâ‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏´‡∏≤',
            'crime_scene': '‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡πÉ‡∏ô‡∏Ñ‡∏î‡∏µ',
            'damage_amount': '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢',
            'suspect_name': '‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤',
            'age': '‡∏≠‡∏≤‡∏¢‡∏∏',
            'nationality': '‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥',
            'address': '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏∏‡πà',
            'id_card': '‡πÄ‡∏•‡∏Ç ‡∏õ‡∏ä‡∏ä',
            'occupation': '‡∏≠‡∏≤‡∏ä‡∏µ‡∏û',
            'court': '‡∏®‡∏≤‡∏•',
            'warrant_no': '‡πÄ‡∏•‡∏Ç‡∏´‡∏°‡∏≤‡∏¢',
            'warrant_date': '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏±‡∏ö',
            'warrant_issued': '‡∏•‡∏á‡∏´‡∏°‡∏≤‡∏¢',
            'petition_day': '‡∏ß‡∏±‡∏ô‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á',
            'petition_month': '‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏¢‡∏∑‡πà‡∏ô',
            'petition_year': '‡∏õ‡∏µ‡∏¢‡∏∑‡πà‡∏ô',
            'arrest_date': '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö ',
            'arrest_time': '‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏±‡∏ö',
            'arrest_location': '‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö',
            'arresting_officer': '‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡∏à‡∏±‡∏ö',
            'witness_1': '‡∏û‡∏¢‡∏≤‡∏ô1',
            'witness_2': '‡∏û‡∏¢‡∏≤‡∏ô2',
            'charges': '‡∏Ç‡πâ‡∏≠‡∏´‡∏≤',
            'facts': '‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á',
            'transfer_date': '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤',
            'transfer_time': '‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡πà‡∏á‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤',
            'transfer_agency': '‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á',
            'receiver': '‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á',
            'court_order': '‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏®‡∏≤‡∏•',
            'order_no': '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á',
            'order_date': '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á',
            'case_result': '‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Ñ‡∏î‡∏µ',
            'judgment': '‡∏ú‡∏•‡∏Ñ‡∏≥‡∏û‡∏¥‡∏û‡∏≤‡∏Å‡∏©‡∏≤',
            'judgment_date': '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏¥‡∏û‡∏≤‡∏Å‡∏©‡∏≤',
            'notes': '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏',
            'court_notes': '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏®‡∏≤‡∏•',
            'judgment_notes': '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏û‡∏≤‡∏Å‡∏©‡∏≤',
            'case_status': '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏î‡∏µ',
            'document_creator': '‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£',
            'document_date': '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£',
            'additional_notes': '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°'
        }